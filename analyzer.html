<html>
<title>Thread Dump Analyzer</title>
<link href="analyzer.css" media="all" rel="stylesheet" type="text/css" />
<textarea id="dump" style="width:100%;height:10em">
</textarea><br />
<button id="parse-action">parse</button>
<input type="file" id="load-dump" value="load dump" />
<a href="#" id="scroll-top">^^^</a>
<pre id="parse-result">
</pre>

<script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
<script src="analyzer.js"></script>
<script>
$(function(){
  function loadFile(files){
    if(files && files[0]){
      var fileReader = new FileReader();
      fileReader.onload = function(e){ $("#dump").val(e.target.result); }
      fileReader.onerror = function(){ alert("can't read!"); }
      fileReader.readAsText(files[0]);
    }
  }
  $("#parse-action").click(function(){
    parse($("#dump").val().split(/\r\n|\r|\n/),$("#parse-result").html(""));
  });
  $("#dump").on("drop",function(e){
    if(e.originalEvent && e.originalEvent.dataTransfer && e.originalEvent.dataTransfer){
      loadFile(e.originalEvent.dataTransfer.files);
    }
    return false;
  });
  $("#load-dump").on("change",function(e){
    if(e.target){
      loadFile(e.target.files);
    }
    return false;
  });
  $("#scroll-top").click(function(){
    $("#dump").scrollTop(0);
  });
});
</script>
</html>
